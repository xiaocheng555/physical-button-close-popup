import{e as K,f as $,g as x,h as V,i as I,j as N,k as O,d as S,l as T,w as f,m as U,u as b,n as H,P as M,o as P,p as R,q as C,c as j,a as t,b as r,r as _,s as L,t as z,v as q,T as G,_ as J}from"./index.39a5b4b0.js";import{i as g}from"./1.3ef2554b.js";const W={modelValue:{type:Boolean,default:!1},queryKey:{type:String},queryValue:{type:[Number,String,Boolean],default:!0},queryExtends:{type:Object,default:{}},defaultCloseOnNoBack:{type:Boolean,default:!1},defaultCloseOnMount:{type:Boolean,default:!1}};function X(c){history.replaceState({...history.state,...c},"")}function Y(c){const d=O();if(!d)throw new Error("getCurrentInstance is null");const s=K(),a=$(),{emit:v}=d,o=d.props;let E=!1;const p=x({get(){return o.modelValue},set(e){v("update:modelValue",e)}}),n=x(()=>o.queryKey&&(c||"")+o.queryKey);function A(){k()}function h(){u()?s.back():y()}function u(){var e;return((e=window.history.state)==null?void 0:e.popupKey)===n.value}async function k(){var e,i;if(!F()){const w={...a.query,...o.queryExtends};n.value&&(w[n.value]=((i=(e=o.queryValue)==null?void 0:e.toString)==null?void 0:i.call(e))||""),await s.push({query:w}),X({popupKey:n.value})}}function y(){if(n.value&&F()){const e={...a.query};delete e[n.value];for(let i in o.queryExtends)delete e[i];s.replace({query:e})}}function F(){const{query:e}=a;return n.value&&n.value in e}function D(){var i;if(!n.value)return;const e=F();if(!e&&p.value&&(p.value=!1),e&&!p.value){if(o.defaultCloseOnNoBack&&!((i=window.history.state)!=null&&i.back)){y();return}if(o.defaultCloseOnMount&&!E)return;p.value=!0}}return V(p,e=>{e?A():h()}),V(()=>n.value,()=>{console.warn(`[HistoryPopup] \u4F20\u5165\u5C5E\u6027\u503C queryKey: ${n.value} \u4E0D\u5EFA\u8BAE\u4FEE\u6539`)}),V(()=>a.query,D,{immediate:!0}),I(()=>{p.value&&A()}),N(()=>{E=!0}),{dialogVisible:p}}const B=S({__name:"HistoryPopup",props:{...W},setup(c){const{dialogVisible:d}=Y();return(s,a)=>(P(),T(b(M),U({show:b(d),"onUpdate:show":a[0]||(a[0]=v=>H(d)?d.value=v:null)},s.$attrs,{"lock-scroll":!1}),{default:f(()=>[R(s.$slots,"default")]),_:3},16,["show"]))}}),m=c=>(L("data-v-299c9215"),c=c(),z(),c),Z={class:"detail-page"},ee=["src"],ue=m(()=>r("h2",{class:"title"},"\u7CBE\u7F8E\u6302\u4EF6",-1)),te=m(()=>r("p",{class:"desc"},"Q\u7248\u9E21\u4F60\u592A\u7F8E\u94A5\u5319\u6263\u6302\u4EF6\u59EC\u9713\u592A\u7F8E\u57FA\u5C3C\u592A\u7F8E\u94A5\u5319\u6263ikun",-1)),oe={class:"popup-content"},ne=["src"],se=m(()=>r("span",{class:"popup-price"},"\xA514.80",-1)),ae=m(()=>r("p",null,"\u670D\u52A1\u4FDD\u969C\uFF1A7\u5929\u65E0\u7406\u7531",-1)),le=m(()=>r("p",null,"\u989C\u8272\u5206\u7C7B\uFF1A\u9E21\u4F60\u592A\u7F8E\u94A5\u5319\u62631\u4E2A \u9AD8\u8D28\u91CF\u7248\u672C \xA514.80",-1)),re=m(()=>r("p",null,"\u8D2D\u4E70\u6570\u91CF\uFF1A1",-1)),ie=q("\u670D\u52A1\u8BF4\u660E"),ce=q("\u786E\u5B9A"),de={class:"preview"},pe=["src"],_e=q("\u670D\u52A1\u8BF4\u660E"),fe=S({__name:"Detail",setup(c){const d=K(),s=C(!1),a=C(!1),v=C(""),o=C(!1),E=C([{id:"1",name:"\u5F20\u4E09",tel:"13000000000",address:"\u6D59\u6C5F\u7701\u676D\u5DDE\u5E02\u897F\u6E56\u533A\u6587\u4E09\u8DEF 138 \u53F7\u4E1C\u65B9\u901A\u4FE1\u5927\u53A6 7 \u697C 501 \u5BA4",isDefault:!0}]);function p(){d.back()}function n(){s.value=!1,G("\u6DFB\u52A0\u6210\u529F")}function A(){o.value=!1}return(h,u)=>{const k=_("van-nav-bar"),y=_("van-action-bar-icon"),F=_("van-action-bar-button"),D=_("van-action-bar"),e=_("van-cell"),i=_("router-link"),w=_("van-button"),Q=_("van-address-list");return P(),j("div",Z,[t(k,{title:"\u7CBE\u7F8E\u6302\u4EF6","left-arrow":"",onClickLeft:p}),r("img",{class:"banner",src:b(g),alt:""},null,8,ee),ue,te,t(D,null,{default:f(()=>[t(y,{icon:"shop-o",text:"\u5E97\u94FA"}),t(y,{icon:"chat-o",text:"\u5BA2\u670D"}),t(y,{icon:"star-o",text:"\u6536\u85CF"}),t(F,{type:"danger",text:"\u52A0\u5165\u8D2D\u7269\u8F66",onClick:u[0]||(u[0]=l=>s.value=!s.value)})]),_:1}),t(B,{queryKey:"popup",queryValue:String(new Date().getTime()),modelValue:s.value,"onUpdate:modelValue":u[3]||(u[3]=l=>s.value=l),position:"bottom"},{default:f(()=>[r("div",oe,[r("img",{class:"popup-img",src:b(g),onClick:u[1]||(u[1]=l=>a.value=!0)},null,8,ne),se,t(e,{title:"\u9009\u62E9\u5730\u5740","is-link":"",value:v.value?E.value[0].address:"",onClick:u[2]||(u[2]=l=>o.value=!0)},null,8,["value"]),ae,le,re,t(i,{style:{"font-size":"13px"},to:"/about"},{default:f(()=>[ie]),_:1}),t(w,{class:"popup-btn",color:"linear-gradient(to right, #ff6034, #ee0a24)",block:"",round:"",onClick:n},{default:f(()=>[ce]),_:1})])]),_:1},8,["queryValue","modelValue"]),t(B,{queryKey:"preview",modelValue:a.value,"onUpdate:modelValue":u[4]||(u[4]=l=>a.value=l)},{default:f(()=>[r("div",de,[r("img",{class:"preview-img",src:b(g)},null,8,pe),t(i,{class:"preview-link",to:"/about"},{default:f(()=>[_e]),_:1})])]),_:1},8,["modelValue"]),t(B,{style:{top:"0"},queryKey:"address",modelValue:o.value,"onUpdate:modelValue":u[7]||(u[7]=l=>o.value=l),position:"bottom"},{default:f(()=>[t(k,{title:"\u9009\u62E9\u6536\u8D27\u5730\u5740","left-arrow":"",onClickLeft:A}),t(Q,{modelValue:v.value,"onUpdate:modelValue":u[5]||(u[5]=l=>v.value=l),list:E.value,onSelect:u[6]||(u[6]=l=>o.value=!1)},null,8,["modelValue","list"])]),_:1},8,["modelValue"])])}}});const me=J(fe,[["__scopeId","data-v-299c9215"]]);export{me as default};
